reticulate::source_python('~/Alyssa/SC_CHIP_HIV_Diabetes/scripts/metacells.py')
reticulate::repl_python()
knitr::opts_knit$set(root.dir = "~/Alyssa/Single_Cell_CHIP/")
library(tidyverse)
library(Seurat)
library(DESeq2)
library(SingleCellExperiment)
library(scuttle)
library(apeglm)
knitr::opts_knit$set(root.dir = "~/Alyssa/Single_Cell_CHIP/")
library(tidyverse)
library(Seurat)
library(DESeq2)
library(SingleCellExperiment)
library(scuttle)
#library(apeglm)
source("scripts/image_formatting.R")
diet_seurat_trimmed = readRDS("rds_objects/diet_seurat_trimmed.rds")
counts = diet_seurat_trimmed@assays$RNA
revision_seurat = subset(diet_seurat_trimmed, subset = MUTATION.GROUP == "TET2")
revision_seurat$MUTATION.SUBGROUP = "placeholder"
revision_seurat$MUTATION.SUBGROUP[revision_seurat$MUTATION %in% c("TET2 V1900F (2%)", "TET2 G68X (2%)", "TET2 (33%)", "TET2 (6.2%)", "TET2 C1378Y (23%)")] = "TET2"
revision_seurat$MUTATION.SUBGROUP[revision_seurat$MUTATION %in% c("TET2 R1516X (30%), TET2 Q659X (29%), SRSF2 P95H (3%)", "SRSF2 P95R (40%), TET2 L957Ifs*15 (51%)", "SRSF2 (33%), TET2 Y1245Lfs*22 (27%), TET2 Q742X(42%)")] = "TET2_SRSF2"
revision_seurat$Cell_Type_Group = paste(revision_seurat$cell_type, revision_seurat$MUTATION.SUBGROUP, revision_seurat$STIM)
revision_seurat = subset(revision_seurat, subset = cell_type == "CD14 Monos")
counts = revision_seurat@assays$RNA
reticulate::repl_python()
